\documentclass[12pt]{article}
\usepackage{verbatim}
\usepackage[dvips]{epsfig}
\usepackage{color}
\usepackage{url}
\usepackage[colorlinks=true]{hyperref}
\usepackage{enumitem} % [noitemsep,nolistsep] compact itemize/enumerate etc.
\usepackage[margin=2cm]{geometry}

% Typeface
\usepackage[condensed,math]{iwona}
\usepackage[T1]{fontenc}

% Remove spacing following headings, ie. implement \usepackage[compact]{titlesec}
%\titlespacing{\section}{0pt}{*0}{*0}
%\titlespacing{\subsection}{0pt}{*0}{*0}
%\titlespacing{\subsubsection}{0pt}{*0}{*0}

% Remove section numbering
\setcounter{secnumdepth}{0}

% Inter-repository linking
\newcommand{\heterarchxref}[2]{\href{#1}{#2}}

 % Generate a nicely located tilde
\newcommand{\mytilde}{\raise.17ex\hbox{$\scriptstyle\mathtt{\sim}$}}

\begin{document}

\section{Heterarch: Documentation}

{\bf Related Documentation:}
% start: userdocs-tag-replace-items related-do-nothing
% end: userdocs-tag-replace-items related-do-nothing

\section{Developer Content Management Documentation}

This document provides information for the {\bf \small Heterarch} Content Management System ({\bf \small HCMS}).

\subsection{Software}

\subsubsection{Interaction with {\bf \small HCMS} Functionality}

The digital publication (d-pub) functionality of an {\bf \small HCMS} implementation is controlled in one of the following three ways:

\begin{enumerate}[noitemsep,nolistsep]
\item{\bf Browser Interface:} This is the user level interface. It allows users to interact with a named repository known to the {\bf \small HCMS}.
\item {\bf The Heterarch Developer Content Management Graphic User Interface (HDC-GUI):} This is the preferred developer interface. The commands the {\bf \small HDC-GUI} implements are the same as those available from the command line interface. It is accessible by repository owners and other authorized content developers.
\item {\bf Command Line Interface:} All functionality of a {\bf \small HCMS} repository can be accessed and controlled from a command line prompt in a terminal window. This is the original developer level interface.
\end{enumerate}

\subsection{Heterarch Developer Content Management Graphic User Interface (HDC-GUI)}

To simplify content management and development, a Graphic User Interface (GUI) referred to as the HDC-GUI is available.\\
\noindent The {\small \bf HDC-GUI} is started from an (X-Window) command line prompt with the following command:
\begin{verbatim}
heterarch-gui
\end{verbatim}
It is the primary management tool for a given repository. The figure below illustrates the appearance of the GUI when accessing the {\tt \small heterarch} repository.

\begin{figure}[h]
   \centering
   \includegraphics[scale=0.4]{figures/heterarch-developer-content-gui.eps}
\end{figure}

\subsection{CF-GUI Components}

Once the {\bf \small HDC-GUI} is initiated it displays four horizontally arranged functional components.\\
Component functionality is given by the title at the head of each column and includes (from left to right): ``Locally Available Package Tags'', ``Locally Available Packages'', the ``Package Information'' window, and the ``Package Operations'' buttons.\\
Their functionality is now introduced.

\begin{description}[noitemsep,nolistsep]
\item {\bf Locally Available Package Tags:}\\
--Tags under this heading give a list of the package domains known to the {\bf \small HCMS}.\\
--Package domains can be selected individually. For convenience two buttons are included for selecting or deselecting all package domains.\\
--Selecting the check-box to the left of a given package domain tag generates a list of packages associated with the selected domain. This list is displayed in the adjacent {\bf \small Locally\,Available\,Packages} window.

\item{\bf Locally Available Repository}\\
--The window under the name bar lists all locally accessible repositories within the selected (adjacent check-box) package tags.\\
--Selecting an available package generates a listing of information about the package in the  {\bf \small Package\,Information} window.\\
--For convenience two buttons are included for selecting or deselecting all listed repositories.

\item{\bf Package\,Information}\\
The {\bf \small Package\,Information} window gives information about the location, status, and contents of the selected available package. The listing is obtained through the version control functionality of {\bf \small HCMS}.  It includes:

\begin{description}[noitemsep,nolistsep] 
\item {\bf Repository name:}\\
	In the {\small \bf CF-GUI} example given above, {\bf \small heterarch}.
\item {\bf Location of package build script generating report:}\\
	For the given example, {\tt \small /usr/local/bin/neurospaces\_build}.
\item {\bf Repository information known to version control:}\\
	Includes package and repository name, IP number of the server where the repository is located, and the repository tags.
\item {\bf Version control summary:}\\
	Includes content revision ID number and revision parent ID number. The name of the authorized content developer, date and time content item changes were put under version control, and the repository branch where the changes will be made.
\item {\bf Content changes:}\\
	The content items accessed and altered in the {\small \bf workspace} are listed.
\item {\bf Missing files:}\\
	Any files found to be missing in the {\small \bf workspace} are listed. (in the example given above, no files were found to be missing.)
\item {\bf Unknown files:}\\
	Any files in the {\small \bf workspace} but not under version control are listed.
\item {\bf Known files:}\\
	All files in the {\small \bf workspace} known to version control and thus known to the {\bf \small HCMS}.
\end{description}

\item{\bf Package Operations}

Buttons listed under this heading provide the following {\bf \small HCMS} functionality:

\begin{description}[noitemsep,nolistsep] 
\item {\bf repositories}\\
	Run operation {\tt \small neurospaces\_repository}.
\item {\bf status}\\
	Run operation {\tt \small neurospaces\_status}.
\item {\bf upgrade}\\
	Run operation {\tt \small neurospaces\_upgrade}.
\item {\bf content\underline{s}ync}\\
	Run operation {\tt \small neurospaces\_content\_sync}.
\item {\bf content\underline{b}uild}\\
	Run operation {\tt \small neurospaces\_build}.
\item {\bf content\underline{c}heck}\\
	Run operation {\tt \small neurospaces\_content\_check}.
\item {\bf dev\underline{u}ninstall}\\
	Run operation {\tt \small neurospaces\_dev\_uninstall}.
\item {\bf serve}\\
	Run operation {\tt \small neurospaces\_serve}.
\end{description}

\end{description}

\subsection{Manually Create New Repository}

Although a fully distributed system, the {\bf \small HCMS} still currently retains the notion of server and client. This is particularly the case for the process of creating a new repository. 

\begin{description}

\item {\bf Server Side}

\item {\bf Client Side}\\

To manually create a new repository on your local machine the following two steps must be completed. The third step gives what to do if you make a mistake. The final sep confirms you have the necessary write access to participate is the {\bf\ \small HCMS}.

\begin{enumerate}[noitemsep,nolistsep]
\item Contact {\bf \small Three\,Way\,Street} with the name of your new repository. In return you will receive a new build configuration. It should be added to your local configuration file located at:\\
  \hspace*{5mm}{\tt /etc/neurospaces/developer/build.yml}
  
You can check the status of this file with the following command entered at a command line prompt in a terminal window:
\begin{verbatim}
neurospaces_packages
\end{verbatim}
This command returns a list of known packages including the name of the new package. It confirms addition of the new build configuration to the {\tt \small build.yml} configuration file was successful:
\begin{verbatim}
---
enabled packages in order of build:
    - developer
    - heterarch
    - tws
    - occupy
    - cough-cough
    - head-full-of-flames
    - overflow-design
    - evil-lurked-in-the-mud
    - the-froggy-bottom-sisters
\end{verbatim}
Note: As it is a yml file, the {\tt \small build.yml} file is white space sensitive.

  \marginpar{we should fold this in into the {\bf \small
      Configurator}, a package that has been under design for 7 years
    or so, now seems the right time to implement it.}
\item The following commands should then be run in the given order at a command line prompt  in a terminal window.\\
(Note: You should replace $<$repository-name$>$ with the name of the repository you want to build. To simplify naming, we recommend you follow the {\bf \small HCMS} naming convention: Replace white space with a single dash (-):
\begin{verbatim}
	neurospaces_create_directories <repository-name>
	neurospaces_pull <repository-name>
	neurospaces_update <repository-name>
	neurospaces_install <repository-name>
\end{verbatim}
\item If you make a mistake you can remove what you have done by running the following commands:
\begin{verbatim}
	cd ~/neurospaces_project/<repository-name>
	rm -fr source/snapshots/0
	cd ~/neurospaces\_project
	rm MTN/<name>.mtn
\end{verbatim}

\item {Check write access where necessary}
\begin{verbatim}
neurospaces_sync <repository-name>
\end{verbatim}
\end{enumerate}

\end{description}

\subsection{Manual Content Creation}

The command to create a new content item may be issued manually at a command line prompt when it is located within the repository where the item is to be created.

{\bf There must be only one content item located in each in each content item folder/directory.}

The content item name should follow the {\bf \small HCMS} content-naming convention--words in the name are separated by a single dash--where {\tt <\dots>} is replaced with the unique name. The command takes the following:
\begin{verbatim}
	<repository-name>-create <content-name>
\end{verbatim}

This command automatically generates the unique content management structure required to support a given content item. The structure is obtained from a built-in content item template called {\it NewDocument} which is automatically placed in a repository when it is created.

\subsubsection{NewDocument Template}

The {\it NewDocument} directory/folder provides a template for the creation of a new text-based content item.\\
{\bf Importantly}, the name of this directory/folder and its contents should not be changed.\\
By default, {\it NewDocument} contains two relevant files and a directory, as well as any other {\bf \small} files or directories required to locally manage the content item within the repository:

\begin{description}[noitemsep,nolistsep] 
	\item {\tt descriptor.yml}\\
	The name of the descriptor file\,{\it descriptor.yml} should never be changed. The default contents of this file include: attributes (terminated by a colon) and tags (indicated by a hyphen).
	\item {\tt NewDocument.tex}\\
	The default content creation editor for {\bf \small HCMS} is \LaTeXe. If you want to use a different editor, at any time prior to content creation, the default may be changed to your preferred format by replacing the NewDocument file with a file in a format of your choice and recognized by the {\bf \small HCMS}. These include: OpenOffice ({\tt odf}--the preferred default format), MS Word ({\tt doc}), Rich Text Format ({\tt rtf}), and Structured Text Format ({\tt rst}).
	\item {\tt figures}\\
	The name of the {\it figures} directory should never be changed. Figures to be included in a content item are located in this directory/folder. The format of these files will be determined by the requirements of the content item file format you choose. For \LaTeXe, the {\it figures} format is Encapsulated Postscript ({\tt eps}).
\end{description}

\subsubsection{Descriptor File}

Individual content items are maintained in association with a unique human readable, YAML-based file named {\it descriptor.yml}. This file is white space sensitive and contains four attribute lines (indicated by a colon ``:''). The first three {\it descriptorfile.yml} attributes are self explanatory and include, (i) a comment line, (ii) one line description of the associated content item (both indicated by: {\small{$<\ldots>$}}), (iii) and the name of the given content item in the repository (automatically inserted into the descriptor file when it is generated during content item creation). The fourth attribute is divided into two types of ``tag'' (indicated by a hyphen ``-''  and {\small{$<<\ldots>>$}}).

The two types of tag recognized by {\bf \small HCMS} include, (i) control tags that define relationships between content items, and their type and visibility, and (ii) automatically generated data tags which define data flows independently of any internal hyperlinking between content items. These tags can be used to organize content items and create, for example, reader flows.

The default form of the descriptor file is:
\begin{verbatim}
---
comment: <Optional comment.>
description: <One line description of content item.>
document name: content-name
tags:
  - <<identifier--order number>>
  - <<domain--order number>>
  - <<format>>
  - <<visibility>>
\end{verbatim}
Angle braces (e.g. {\small{$<\ldots>$}}) should be manually replaced as described above.
\begin{description}
\item{\tt -{}-{}-}\\
The three dashes on the first line of the descriptor file are part of the \href{http://yaml.org}{\bf \small YAML} syntax for automated software engineering. \\
{\bf Note:} The meaning of the white space/indents in the descriptor file is defined for YAML.
\item{\tt comment:}\\
Optional comment about the content item, e.g. reason for being tagged {\tt -\,obsolete}.
\item{\tt description:} The default file description should be replaced with a short description of the subject matter of the content item. It is recommended that this description is less than 80 characters on a single line.
\item[]{\tt document\,name:}\\
The name of the associated content item is automatically inserted after this attribute during creation of a new content item. This name can be used as a link to the given content item in the {\bf \small HCMS}.\\
As the name as it appears here is independent of the name of the content item known to the {\bf \small HCMS}, it can be manually changed to give a more human readable form, e.g. for viewing in a browser.
\end{description}

We now introduce the {\bf \small HCMS} tagging system.

\subsubsection{Descriptor File Tags}

Tags in a descriptor file are order independent but for convenience, and as a {\bf \small HCMS} convention, it is best if the given order is maintained. Two classes of descriptor file tags are recognized. 

\begin{description}[noitemsep,nolistsep]
\item {\bf Control tag:}\\
Control tags are static, pre-defined, historically imposed on content components, human relevant to a given domain, and are employed to organize content items within a repository.\\
Importantly, both identifier and domain control tags may optionally be concatenated (via a double dash: -{}-) with an order number tag. 

The order number tag defines: (i) whether multiple individual content items will be concatenated into a single content item, and (ii) the order in which these content items are concatenated. In the absence of an order number tag, a control tag will define which domain a content item belongs too as a stand-alone item.\\
In more detail, all content items associated with a {\it descriptor.yml} file that contains an identifier tag without an associated order number tag {\bf ********To be completed}
\item {\bf Data tag:}\\
Data tags are dynamic and employed to characterize individual content items and organize them for subsequent retrieval and exploration. These tags are automatically extracted from a content item and appended to the associated descriptor file in a given repository at the time a new content item is put under version control. These tags are updated automatically with each change of a content item that is made known to the version control system.\\
Data tags are automatically concatenated with an order number (also via a double dash: -{}-) at the time of their creation.
\end{description}

\subsubsection{Control tags}

Indicated by {\small $<<\ldots>>$} in the descriptor file. Control tags from the following list should be inserted at the time of content creation. New control tags may be added but, until they are incorporated into a new software release, they will be interpreted and treated as data tags by {\bf \small HCMS}. The meaning of each control tag is as follows:

\begin{description}[noitemsep,nolistsep]
\item {\tt identifier-{}-order number}\\
	The repository identifier and order number tags are separated by a double dash '-{}-', e.g. {\small \tt my-book-{}-100} (refers to the 100th item when content items are concatenated to create an e-publication).\\
	The purpose of the order number is to create a ``reader flow'' that is independent of any internal hyperlinking of the individual contents of an e-publication.
	\begin{description}[noitemsep,nolistsep]
	\item {\tt identifier}\\
	Gives the name of the repository within which a given content item is located.
	\item {\tt order}\\
	The order number is a unique value for a given identifier or tag type. It defines the order of the associated content item when it is concatenated. In the absence of an order number, {\bf To be completed.}\\
	To facilitate the addition of new content to an e-publication, the order number may be extended from an integer to a floating point value. 	This allows new content to be interleaved within existing content.\\
	Content items with larger order tag values follow content items with lower  values.
	\end{description}
\item{\tt domain}\\
Gives the domain to which a given content item belongs. {\bf \small HCMS} default tags recognized, include:
	\begin{description}[noitemsep,nolistsep]
	\item {\tt test}\\
	Identifies a content item employed to test system functionality during software or content development.
	\item {\tt developer-content}\marginpar{developer-content or content-developer?}\\
	Identifies content developer documentation.
	\item {\tt developer-software}\\
	Identifies software developer documentation.
	\item {\tt user-content}\\
	Identifies content user documentation.
	\item {\tt user-software}\\
	Identifies software user documentation.
  	\item{\tt wav}\\
	Identifies the Microsoft digital audio {\tt \small wav} encoding file format.
  	 \item{\tt mp3}\\
	 Identifies the digital audio {\tt \small mp3} encoding format.
	\item {\tt video}\\
	To incorporate video into a content item:
		\begin{description}[noitemsep,nolistsep]
		\item Create an account with a video sharing website, e.g. \href{http://www.youtube.com/watch?v=1n8DxTk2gVM}{\bf YouTube}.
   		\item Upload your video(s).
  		\item Embed a link to the video(s) into the content item.
		\end{description}
	\item {\tt image}\\
	Identifies a photograph, painting, poster, illustration, graph, table, etc.
%	\item {\tt post}\\
%	Indicates the given content item will not be concatenated into an e-publication. Indicates a single stand-alone content item (for example, a blog roll) that may aggregate other content items, e.g. video, sound, photographs, etc.
%	\item {\tt concatenated}\\
%	Indicates a single content item, under version control and tagged ``published,'' that is created by concatenation into a single content item according to order tags.
	\item {\tt cover}\\
	Front cover page.
	\item {\tt half-title}\\
	Half-title page.
	\item {\tt full-title}\\
	Full-title page.
	\item {\tt copyright}\\
	Page listing publication, catalog, and copyright information.
	\item {\tt dedication}\\
	Dedication and print information.
	\item {\tt contents}\\
	Contents page(s).
	\item {\tt acknowledgements}\\
	Acknowledgements page(s).
	\item {\tt preface}\\
	Preface or foreword page(s).
	\item {\tt chapter}\\
	Single chapter.
%	\item {\tt part}\\
%	Given content item is a part of an e-publication, usually a single page.
	\item {\tt band-local}\\
	Indicates local band related content.
	\item {\tt band-interstate}\\
	Indicates interstate band related content.
	\item {\tt band-international}\\
	Indicates international band related content.
	\item {\tt appendix}\\
	Appendix page(s).
	\item {\tt index}\\
	Index page(s).
	\item {\tt back}\\
	Back cover page.
	\end{description}
\item{\tt format}\\
The format identifier tag indicates the file format of the given content item. File formats recognized by the {\bf \small HCMS}, include:
	\begin{description}[noitemsep,nolistsep]
	\item {\tt doc}\\
	Microsoft Word.
	\item {\tt odf}\\
	OpenOffice, the preferred file format.
	\item {\tt pdf}\\
	Postscript document format.\\
	{\bf Importantly, to include a file in pdf format as a content item, several things must be ensured:}
		\begin{enumerate}
		\item The name of the content item folder/directory (excluding the extension) and the pdf file must be identical, e.g. {\tt \small my-content/my-content.pdf}.
		\item The pdf file must be located in the content item folder/directory and not in the {\it figures} directory.
		\item As there can be only one content item within each content item folder/directory, any default {\it NewDocument} file or file with a file extension known to the {\bf \small HCMS} must be removed.
		\end{enumerate}
	\item {\tt rst}\\
 	Structured text.
	\item {\tt rtf}\\
	Rich text format.
	\item {\tt tex}\\
 	\LaTeXe.
	\end{description}
\item{\tt visibility}\\
There are several tags that control publication of {\bf \small HCMS} content items.
	\begin{description}[noitemsep,nolistsep]
		\item {\tt unknown}\\
		This tag does not have to be added to the descriptor file. It is included for completeness and indicates the most restricted visibility of a content item. It  identifies a content item present in a given repository that has not yet been placed under version control. Such a content item is `unknown' to {\bf \small HCMS} (and version control). It may only be viewed by those authorized to directly access a repository where the given content item actually exists.
		\item {\tt obsolete}\\
		This tag is used to identify obsolete content items under {\bf \small HCMS} version control that are ignored when a content build is performed.
		\item {\tt local}\\
		This tag indicates that a document will be included into any local build of the {\bf \small HCMS}. The presence of this tag means that a document will be browser viewable on (a) local machine(s), but will not appear as a `published' document on a web site. This tag is useful to content developers for checking documentation prior to publication on the web and can be used to control who can view documentation locally.
		\item{\tt draft}\\
		Visibility of a content item is restricted to the owner and to others the repository owner has authorized access, typically authorized content providers.
		\item{\tt published}\\
		Unrestricted browser visibility of the given content item on the internet.
	\end{description}
\end{description}

\subparagraph{\bf Specific descriptor file example:} The contents of the descriptor file for the front cover of {\bf \small HFoF} is given:

\begin{verbatim}
---
comment: Optional comment.
description: Front cover page for head-full-of-flames e-publication.
document name: hfof-pg-1
tags:
  - head-full-of-flames--1
  - cover
  - pdf
  - draft
\end{verbatim}

Note: Data tags are not included for this content item as it comprises a single page {\tt \small pdf} file which is not considered by the {\bf \small HCMS} to contain body copy text.

Source content for {\bf \small HFoF} e-publication are currently produced with the \LaTeXe\,typesetting package (see \href{http://www.latex-project.org/}{\bf www.latex-project.org}).

\subsubsection{E-publication Extension}
\marginpar{needs to be developed, then the documentation updated}
The content of an e-publication may be extended by an authorized content developer in one of two ways:
\begin{enumerate}[noitemsep,nolistsep]
\item {\bf Concatenated extension:}\\
An authorized content developer can share content between repositories by including the appropriate ``identifier/order'' tags in the descriptor file of the content to be shared.\\
{\bf \small HCMS} concatenation functionality can be employed locally to check new content is appropriately included.\\
For the purpose of content order adjustment, the {\bf \small HCMS} concatenation functionality only operates on the content belonging to a given content developer.
\item {\bf Hyperlink extension:}\\
Content developers can create two types of hyperlink to extend an e-publication:
	\begin{enumerate}[noitemsep,nolistsep]
	\item {\bf Content item hyperlinks:}\\
	An authorized content developer can hyperlink from within a given content item to any content item(s) they are authorized to access. Thus, content item hyperlinking may be made between content items or within a single content item. 
	\item {\bf Content hyperlinks:}\\
	An authorized content developer can link from within any content they own to any (body copy) text within a page of the concatenated e-publication.\\
	An authorized content developer can link from within content they own to any linkable location on the internet.
 	\end{enumerate}
\end{enumerate}

\subsection{HCMS Version Control}

Version control of the {\bf \small HFoF} e-publication system is currently handled by the monotone software package. Monotone is an open source distributed version control tool that can help automate many of the tedious and error-prone tasks required for group content management, e.g.
\begin{itemize}[noitemsep,nolistsep]
\item Store multiple versions of files you are working on efficiently.
\item Transmit changes to files between you and your authorized content developers.
\item Merge changes you make with those other authorized content developers make.
\item Make notes about your opinion of the quality of versions of files.
\item Make decisions about using or ignoring versions, depending on the notes you receive from other authorized content developers. 
\end{itemize}
Please be aware that monotone is a slightly unorthodox version control tool\marginpar{should say that distributed version control is a hot field undergoing constant change, we selected monotone because of its simple user interface}, and many of its concepts are similar--but subtly or significantly different--from concepts with similar names in other version control tools. 

Monotone provides a simple, single-file transactional version store, with fully disconnected operation and an efficient peer-to-peer synchronization protocol. It understands history-sensitive merging, lightweight branches, integrated code review and 3rd party testing. It uses cryptographic version naming and client-side RSA certificates. It has good internationalization support, has no external dependencies and runs on Linux, Solaris, OSX, Windows, and other Unixes.

\subsubsection{Obtaining Monotone}
Monotone\marginpar{should be installed on the virtual machine that we provide} can be obtained by downloading the package appropriate for your computing platform from the links on the \href{http://monotone.ca/}{\bf monotone} home page.

%\subsection{Installing Monotone on OS X}
%On the monotone home page select the Mac OS X packaged link and download the DMG file.

\subsubsection{Manual Monotone Initialization}

Once the appropriate monotone package has been downloaded and installed on your computer, monotone must be initialized by performing the following steps (commands in the monospaced {\tt \small typewriter} font should be entered from the command line prompt of a terminal window):

\begin{enumerate}[noitemsep,nolistsep]
\item {\bf Generate a monotone key:} 
\begin{verbatim}
    mtn genkey <identifier>
\end{verbatim}
where the {\tt $<$identifier$>$} is unique to you (typically an email account, e.g. yourname@provider). The identifier is located in a {\it .monotone} directory in your home folder located in the {\it /Users} folder.
\item {\bf Initialize the data base}
\begin{verbatim}
    mtn --db=userdocs.mtn db init
\end{verbatim}
This creates the monotone repository file {\it userdocs.mtn} which is referenced with
\begin{verbatim}
    --db=userdocs.mtn
\end{verbatim}
\item {\bf Create a workspace}
\begin{verbatim}
    mtn --db=userdocs.mtn --branch="0" setup userdocs
\end{verbatim}
This creates a workspace directory on your local machine where you put the source files for any content items and documentation that you create. Importantly, there is a specific required structure and content for documents in the {\bf \small HFoF} e-publication system. This is described in detail above. The path to the workspace directory should be
\begin{verbatim}
    ~/neurospaces_project/userdocs/source/snapshots/0
\end{verbatim}
By default, the workspace directory {\tt 0} contains a folder named {\tt \_MTN}. This is part of the monotone version control system and contains information concerning monotone's version control management.

The command
\begin{verbatim}
    mtn --db=userdocs.mtn pubkey <identifier> > me.pubkey
\end{verbatim}
will place a copy of your public key in the file indicated in {\tt --db=userdocs.mtn}.
\end{enumerate}
An automatic login can be set up with monotone by making an executable file containing the following code:
\begin{verbatim}
    ~/.monotone/monotonerc:
        function get_password(keypair_id)
        return <password here>
        end
\end{verbatim}
Further information and help about using monotone, for example resolving conflicts between documents, can be found at:

\href{http://monotone.ca/monotone.html}{\bf http://monotone.ca/monotone.html}.

\section{HFoF E-Publication and the Monotone Version Control System}

Installation and maintenance of {\bf \small HFoF} is fully automated with document versioning under the control of \href{http://monotone.ca/}{\bf monotone}. 

\subsection{Overview}
\marginpar{seems the document and text are out of sync?  Maybe the figure should also be shown earlier, just after the GUI picture.}
In its simplest form,  the {\bf \small HFoF} content item version control system can be seen as having three levels (see figure below):
\begin{enumerate}
\item {\bf The local content item workspace:} Exists at a specified location within the {\bf \small HFoF} developers installation on your local machine. The contents of this workspace are private to the local filesystem.
\item {\bf The private document repository:} Provides the first step in content publication. Documentation version control is initiated by checking documents in your local workspace into the document repository on your local machine.
\item {\bf The public content repository:} Pushing documents from your local repository to the publicly accessible repository makes all documentation in your local repository available (i) for publication on your website and (ii) to become part of the {\bf \small HFoF}. It also allows other authorized content creators to work simultaneously on content items.
\end{enumerate}

\begin{figure}[h]
  \centering
 \includegraphics[scale=0.6]{figures/hfof-monotone.eps}
%  \caption{}
  \label{fig:monotone}
\end{figure}

The components of the monotone version control system are illustrated in the above figure. It shows the relationship between a local workspace, its associated monotone repository, and how after an initial ``check in'' ({\it ci}\,), a document can be ``syncronized'' with one or more remote monotone server databases or repositories known to {\bf \small HCMS} and that participates in the {\bf \small HFoF} e-publication system. Note that documents are private to your local account until they are checked into to your local monotone repository. At this time they become available to be synchronized with authorized remote repositories known to the monotone system.

Once a document is located on a monotone server repository, it is available to be published as part of the {\bf \small HCMS}. This means that it will be automatically incorporated and downloaded as part of the {\bf \small HFoF} e-publication system when it is installed or updated. \marginpar{this text is actually obscure to me ... what does it really mean? \textcolor{red}{HUGO: Can you remove this last sentence if it is not, as I hope, true.}}

\subsection{Monotone Workflow Examples}
\marginpar{we should add as many functions mentioned here, to the GUI}
The following sections give some example workflows for monotone use. More detailed tutorials and documentation are available from the \href{http://www.monotone.ca/docs/index.html}{\bf monotone website}.

\subsection{Updating the Local Workspace}

Updating your local workspace begins with determining which files are registered with monotone. This is done by querying your local monotone repository. This generates a list of any new files that may have been added to your local work space since the last update
\begin{verbatim}
    mtn ls unknown
\end{verbatim}
This command generates a list of all files in your local workspace that are not known to monotone. To have any files that this command lists added to your local repository, enter:
\begin{verbatim}
    mtn add --unknown
\end{verbatim}
Reissuing the ``{\tt mtn ls unknown}'' command should now result in no output.

Alternatively, once files have been registered in your local workspace, the following command reports which have been changed since the last code check in (see following):
\begin{verbatim}
   mtn ls changed
\end{verbatim}

Importantly, the default file type for the GENESIS Documentation System is the \LaTeX\,\,{\bf .tex} file. To register a different file type with monotone and add it to your local workspace, for example a PDF file (see \href{../common-suffixes/common-suffixes.tex}{\bf Common\,Suffixes} for a more complete list of recognized file types), use the following command:
\begin{verbatim}
   mtn add --no-respect-ignore <directory-name>/<file-name>.pdf
\end{verbatim}

The files that have been registered with monotone can now be added to your local repository with the following command:
\begin{verbatim}
    mtn ci
\end{verbatim}
where {\tt ci} stands for ``check in''. Monotone responds by opening the log file indicated in {\tt .\,--db=userdocs.mtn} where the nature of the changes or revision to the document(s) that are being checked in can be recorded.

\subsection{Synchronizing the Local Workspace with the Monotone Repository}

The following procedure is suggested for syncing with repository at the end of each day and/or documentation writing session.

\begin{verbatim}
    mtn ls unknown
        . . .
    mtn add --unknown
\end{verbatim}
These commands add any new files discovered in your local workspace to your local monotone repository. That this has occurred correctly can be checked with
\begin{verbatim}
    mtn ls known .
\end{verbatim}
This command should generate the same list of file names as that returned by the ``{\tt mtn ls unknown}'' command. Note the period ``{\tt .}'' which is part of the command syntax.

You can then check for files in you local workspace that have been deleted or moved
\begin{verbatim}
    mtn ls missing
\end{verbatim}
You can then drop any files missing from your local workspace repository by entering:
\begin{verbatim}
    mtn drop --missing
\end{verbatim}
and then check in the changes to the monotone repository on the server with
\begin{verbatim}
    mtn ci
\end{verbatim}
You can automate the synchronization of your local data base (i.e. a push and a pull) with the monotone repository on the server by placing an executable file (named for example,\,{\it userdocs-sync}) in a bin directory in your local work space, e.g. {\it neurospaces\_project/userdocs/source/snapshots/0/bin}. 
The executable contains the command sequence:
\begin{verbatim}
    neurospaces_sync --enable userdocs --regex userdocs --verbose
\end{verbatim}
and issuing the command
\begin{verbatim}
   userdocs-sync
\end{verbatim}
simultaneously updates the monotone repository on the server and transfers any updates to documentation on the server to your local monotone repository. Once this has been done, the files that have been pushed to the monotone server are available for other registered users to pull down to their own local monotone repository and to check them out ({\it co}) to their local workspace.

\subsection{File Recovery}

The latest version of a file can be recovered with the following command
\begin{verbatim}
   mtn revert <file name> .
\end{verbatim}

\end{document}
